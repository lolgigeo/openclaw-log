# 回归测试清单（二次优化验证）

## 一、页面功能测试

### 1. 首页 (https://md.zeelool.asia/)

| 测试项 | 验证方式 | 预期结果 |
|--------|----------|----------|
| 标题2行截断 | 查看超长标题 | 最多显示2行，溢出显示省略号 |
| 摘要4行截断 | 查看摘要内容 | 最多显示4行，溢出显示省略号 |
| 卡片一致性 | 对比多个文章卡片 | 高度基本一致，视觉整齐 |
| 阅读全文按钮 | 点击按钮 | 正确跳转到文章页 |
| 悬停效果 | 鼠标悬停标题/按钮 | 有平滑的颜色/位置过渡 |
| 分页 | 点击下一页 | 正常跳转，URL 更新 |

---

### 2. 文章页（任选一篇含代码块/表格/标题的文章）

#### 2.1 代码块测试

| 测试项 | 验证方式 | 预期结果 |
|--------|----------|----------|
| 复制按钮显示 | 悬停代码块 | 右上角显示复制按钮 |
| 复制功能 | 点击按钮 | 代码复制到剪贴板，按钮显示 ✓ |
| 复制反馈 | 观察按钮状态 | 2秒后恢复原图标 |
| 长代码滚动 | 查看宽代码块 | 横向可滚动，无换行 |
| 移动端按钮 | 320px宽度测试 | 复制按钮始终可见 |

#### 2.2 表格测试

| 测试项 | 验证方式 | 预期结果 |
|--------|----------|----------|
| 横向滚动 | 宽表格测试 | 表格可横向滚动 |
| 滚动阴影 | 滚动表格 | 左右边缘有阴影提示 |
| 悬停高亮 | 鼠标悬停行 | 行背景色变化 |
| 移动端可读 | 320px宽度 | 字体缩小但可读，无溢出 |

#### 2.3 标题锚点测试（⭐ 新增）

| 测试项 | 验证方式 | 预期结果 |
|--------|----------|----------|
| 锚点显示 | 悬停 h2/h3/h4 | 标题右侧显示 # 符号 |
| 链接复制 | 点击 # | URL 更新，地址栏显示锚点 |
| 锚点偏移 | 点击后观察位置 | 标题距页面顶部 ≥ 80px |
| 键盘可访问 | Tab 键聚焦 # | 焦点环可见，Enter 可触发 |

#### 2.4 阅读进度条测试

| 测试项 | 验证方式 | 预期结果 |
|--------|----------|----------|
| 进度条显示 | 文章页加载 | 页面顶部有蓝绿渐变条 |
| 实时更新 | 滚动页面 | 进度条宽度随滚动变化 |
| 到顶100% | 滚动到底部 | 进度条宽度接近 100% |
| 非文章页隐藏 | 访问首页/归档 | 进度条不显示 |

#### 2.5 回到顶部测试

| 测试项 | 验证方式 | 预期结果 |
|--------|----------|----------|
| 按钮出现 | 滚动 > 300px | 右下角显示蓝色圆形按钮 |
| 平滑滚动 | 点击按钮 | 平滑滚动到顶部 |
| 悬停效果 | 鼠标悬停 | 按钮上浮 2px，颜色加深 |
| 键盘可用 | Tab 聚焦 + Enter | 正常触发滚动 |

---

### 3. 归档页 (https://md.zeelool.asia/archives/)

| 测试项 | 验证方式 | 预期结果 |
|--------|----------|----------|
| 时间线列表 | 查看页面 | 按年/月分组的文章列表 |
| 链接可用 | 点击文章标题 | 正确跳转到文章页 |
| 响应式 | 移动端访问 | 布局正常，无溢出 |

---

### 4. 分类页 (https://md.zeelool.asia/categories/)

| 测试项 | 验证方式 | 预期结果 |
|--------|----------|----------|
| 分类列表 | 查看页面 | 显示所有分类及文章数 |
| 悬停效果 | 鼠标悬停分类项 | 向右平移 5px，背景色变化 |
| 点击跳转 | 点击分类 | 进入该分类的文章列表 |

---

### 5. 标签页 (https://md.zeelool.asia/tags/)

| 测试项 | 验证方式 | 预期结果 |
|--------|----------|----------|
| 标签云 | 查看页面 | 胶囊形状的标签列表 |
| 悬停效果 | 鼠标悬停标签 | 上浮 2px，阴影加深 |
| 点击跳转 | 点击标签 | 进入该标签的文章列表 |

---

### 6. 关于页 (https://md.zeelool.asia/about/) ⭐ 重点

| 测试项 | 验证方式 | 预期结果 |
|--------|----------|----------|
| ✅ **页面可访问** | `curl -I https://md.zeelool.asia/about/` | **返回 200 OK（不再 404）** |
| 内容显示 | 浏览器访问 | 显示完整的关于页内容 |
| 表格显示 | 查看技术栈/更新记录 | 表格渲染正常 |
| 链接可用 | 点击外部链接 | 正确跳转到 GitHub/Email 等 |
| 响应式 | 移动端访问 | 表格可横向滚动 |

---

## 二、场景测试

### 场景 1：320px 极小屏幕

**测试设备**：Chrome DevTools → iPhone SE (320x568)

| 测试项 | 预期结果 |
|--------|----------|
| 首页卡片 | 无横向滚动条，标题/摘要自适应 |
| 代码块 | 字体 12px，可横向滚动 |
| 表格 | 字体 0.8em，可横向滚动 |
| 按钮 | 回到顶部按钮 40x40px，不遮挡内容 |
| 导航 | 菜单项可点击，间距适中 |

---

### 场景 2：暗色模式（⭐ 新增）

**触发方式**：Chrome DevTools → Rendering → Emulate CSS media feature `prefers-color-scheme: dark`

| 测试项 | 预期结果 |
|--------|----------|
| 背景色 | 深色背景（#0d1117） |
| 文字色 | 浅色文字（#c9d1d9） |
| 代码块 | 深色背景，浅色文字 |
| 表格 | 深色背景，边框可见 |
| 链接 | 蓝色（#58a6ff），可读性良好 |
| 对比度 | 所有文字对比度 ≥ 4.5:1 |

---

### 场景 3：键盘导航

**操作**：仅使用 Tab/Shift+Tab/Enter/Space 导航

| 测试项 | 预期结果 |
|--------|----------|
| Tab 顺序 | 逻辑顺序：导航 → 主内容 → 侧边栏 → 页脚 |
| 焦点可见 | 所有可聚焦元素有 3px 蓝色/绿色焦点环 |
| 按钮可触发 | Enter 键可触发所有按钮（复制/回到顶部） |
| 链接可访问 | Enter 键可跳转所有链接 |
| 跳过导航 | Tab 第一个元素是"跳过导航"链接 |

---

### 场景 4：代码复制功能

**测试代码块**：选择包含多行代码的文章

| 测试项 | 操作 | 预期结果 |
|--------|------|----------|
| 复制纯文本 | 点击复制 → 粘贴到文本编辑器 | 无 HTML 标签，保留换行 |
| 重复复制 | 多次点击 | 每次都成功，按钮状态正常循环 |
| 降级兼容 | 禁用 Clipboard API（隐私模式） | 使用 execCommand 降级方案 |

---

### 场景 5：图片懒加载

**测试文章**：选择包含多张图片的文章

| 测试项 | 预期结果 |
|--------|----------|
| 初始加载 | Network 面板仅加载首屏可见图片 |
| 滚动触发 | 滚动到图片位置前 50px 开始加载 |
| 占位效果 | 未加载图片显示灰色背景 |
| 悬停放大 | 加载完成后，悬停图片放大 1.02 倍 |

---

### 场景 6：长文章目录高亮（如果存在 TOC）

**测试文章**：选择有多级标题的长文章

| 测试项 | 预期结果 |
|--------|----------|
| 目录高亮 | 当前可见标题在目录中高亮 |
| 滚动联动 | 滚动文章，目录高亮项自动切换 |
| 锚点偏移 | 点击目录项，标题不被导航遮挡 |

---

## 三、性能测试（Lighthouse / PageSpeed Insights）

### 测试地址
https://pagespeed.web.dev/analysis?url=https%3A%2F%2Fmd.zeelool.asia

### 必须检查的 6 项指标

| 指标 | 目标值 | 验证方式 |
|------|--------|----------|
| **Performance** | ≥ 90 | Lighthouse 评分 |
| **Accessibility** | ≥ 90 | Lighthouse 评分 |
| **Best Practices** | ≥ 90 | Lighthouse 评分 |
| **SEO** | ≥ 95 | Lighthouse 评分 |
| **First Contentful Paint (FCP)** | < 1.8s | Lighthouse Core Web Vitals |
| **Largest Contentful Paint (LCP)** | < 2.5s | Lighthouse Core Web Vitals |

### 性能细节检查

| 检查项 | 验证方式 | 预期结果 |
|--------|----------|----------|
| CSS 文件大小 | Network 面板查看 `custom.css` | < 20 KB |
| JS 文件大小 | Network 面板查看 `custom.js` | < 15 KB |
| 滚动性能 | Performance 面板录制滚动 | FPS ≥ 55 |
| 无控制台错误 | Console 面板 | 0 errors, 0 warnings |
| 资源加载顺序 | Network 瀑布图 | CSS 先于 JS，阻塞资源最少 |
| 图片懒加载 | Network 面板 | 仅首屏图片立即加载 |

---

## 四、无障碍测试（A11y）

### 使用工具
- Chrome DevTools → Lighthouse → Accessibility
- axe DevTools 浏览器插件

### 必须通过的项目

| 测试项 | 验证标准 | 预期结果 |
|--------|----------|----------|
| 对比度 | WCAG AA (4.5:1) | 所有文字通过 |
| 语义化标签 | HTML5 语义 | 使用正确的 h1-h6, nav, main, footer |
| 图片 alt | 所有图片有 alt | 通过（或 role="presentation"） |
| 焦点顺序 | Tab 逻辑顺序 | 符合视觉顺序 |
| 键盘可操作 | 所有交互可用键盘 | 100% 可访问 |
| ARIA 标签 | 按钮/链接有 aria-label | 所有交互元素通过 |

---

## 五、回滚测试

### 回滚操作

```bash
cd /root/website/hexo

# 删除二次优化新增的文件
rm source/css/custom.css
rm source/js/custom.js
rm source/about/index.md
rm scripts/inject-custom-assets.js

# 重新生成
hexo clean && hexo generate

# 部署
./deploy.sh
```

### 回滚验证

| 验证项 | 预期结果 |
|--------|----------|
| 页面正常访问 | 首页/文章页无错误 |
| 主题默认样式 | 恢复主题原始外观 |
| 关于页 404 | 再次返回 404（回滚成功标志） |
| 功能失效 | 代码复制/回到顶部/进度条消失 |
| 无控制台错误 | Console 无报错 |

---

## 六、跨浏览器测试（可选）

| 浏览器 | 版本 | 必测功能 |
|--------|------|----------|
| Chrome | Latest | 所有功能 |
| Firefox | Latest | 暗色模式、焦点环 |
| Safari | Latest (macOS/iOS) | 图片懒加载、平滑滚动 |
| Edge | Latest | 复制功能、表格滚动 |

---

## 七、SEO 验证

| 检查项 | 验证方式 | 预期结果 |
|--------|----------|----------|
| Sitemap 可访问 | `curl https://md.zeelool.asia/sitemap.xml` | 200 OK, 有效 XML |
| Robots.txt | `curl https://md.zeelool.asia/robots.txt` | 200 OK, 规则正确 |
| RSS Feed | `curl https://md.zeelool.asia/atom.xml` | 200 OK, 有效 XML |
| Meta 标签 | 查看页面源码 | 有 description, keywords |
| Canonical URL | 查看页面源码 | `<link rel="canonical">` 存在 |

---

## 八、故障排查清单

### 问题 1：自定义样式未生效

**检查步骤**：
1. 查看 Network 面板，`custom.css` 是否 200 OK
2. 检查 HTML 源码，`<link rel="stylesheet" href="/css/custom.css">` 是否存在
3. 浏览器 DevTools → Elements → Computed，查看样式优先级
4. 清除浏览器缓存（Ctrl+Shift+Delete）

**解决方案**：
```bash
hexo clean
hexo generate
./deploy.sh
# 然后在浏览器按 Ctrl+Shift+R 强制刷新
```

### 问题 2：JS 功能失效

**检查步骤**：
1. 打开 Console，是否有错误信息
2. 手动执行 `window.customScriptsReinit()`
3. 检查 DOM 结构是否与预期一致（可能主题更新了结构）

**解决方案**：
- 如果提示 `querySelector returned null`，调整 `custom.js` 中的选择器
- 如果提示 `customScriptsReinit is not defined`，说明 JS 未加载，检查注入脚本

### 问题 3：关于页仍然 404

**检查步骤**：
```bash
# 检查文件是否存在
ls -la /root/website/hexo/source/about/index.md

# 检查生成结果
ls -la /root/website/hexo/public/about/index.html

# 检查 Nginx 配置
cat /etc/nginx/sites-available/md.zeelool.asia | grep root
```

**解决方案**：
- 如果 `source/about/index.md` 不存在 → 重新创建
- 如果 `public/about/index.html` 不存在 → 重新 `hexo generate`
- 如果 Nginx root 路径错误 → 修正配置并 `systemctl reload nginx`

---

## 测试通过标准

### 必须通过（❌ 任何一项失败都需修复）
- ✅ 关于页返回 200 OK（不再 404）
- ✅ 首页标题/摘要正确截断
- ✅ 代码块复制功能正常
- ✅ 暗色模式对比度达标
- ✅ 320px 宽度无横向溢出
- ✅ Lighthouse Accessibility ≥ 90

### 建议通过（⚠️ 失败可容忍，但需记录）
- ✅ Lighthouse Performance ≥ 90
- ✅ 标题锚点功能正常
- ✅ 目录滚动高亮（如果存在 TOC）
- ✅ 图片懒加载生效

---

## 测试报告模板

完成测试后，填写以下报告：

```markdown
# 二次优化回归测试报告

**测试日期**：2026-02-07  
**测试人**：[姓名]  
**站点地址**：https://md.zeelool.asia

## 测试结果概览

| 类别 | 通过项 | 失败项 | 通过率 |
|------|--------|--------|--------|
| 页面功能 | X / Y | Z | XX% |
| 场景测试 | X / Y | Z | XX% |
| 性能测试 | X / 6 | Z | XX% |
| 无障碍 | X / 6 | Z | XX% |

## 关键问题（如有）

1. **问题描述**：
   - 截图：
   - 复现步骤：
   - 影响范围：

## 验收结论

- [ ] ✅ 通过，可上线
- [ ] ⚠️ 通过但有改进建议
- [ ] ❌ 不通过，需修复后重测
```

---

**测试愉快！**
